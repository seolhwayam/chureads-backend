
import OpenAI from "openai";
import 'dotenv/config';

// openai ì„¸íŒ…

   const openai = new OpenAI({
        apiKey : process.env.OPENAI_API_KEY
    })





// íƒœí¬ìƒì„± ì½”ë“œ

const createTagPrompt = (content) => {
 return [
   {
     role: "system",
     content: `ì˜¨ë¼ì¸ ê²Œì‹œê¸€ì„ ì½ê³ , ê°ì •, ì£¼ì œ, ë¶„ìœ„ê¸°, ë§¥ë½ì„ ê¹Šì´ ë¶„ì„í•´ ê·¸ ê¸€ì— ê°€ì¥ ì í•©í•œ í•µì‹¬ íƒœê·¸ 3ê°œë¥¼ í•œê¸€ë¡œ, ê° íƒœê·¸ëŠ” 1~2ë‹¨ì–´ ì´ë‚´ë¡œ ìƒì„±í•˜ì„¸ìš”.

- íƒœê·¸ëŠ” ì£¼ì œ, ê°ì •, ìƒí™©, ë§¥ë½ ë“± ê²Œì‹œê¸€ì˜ ì£¼ìš” ì˜ë¯¸ë¥¼ ë°˜ì˜í•´ì•¼ í•©ë‹ˆë‹¤.
- íƒœê·¸ëŠ” í•œê¸€ì´ì–´ì•¼ í•˜ë©°, ê° íƒœê·¸ëŠ” 1~2ë‹¨ì–´ë¡œ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.
- **ë°˜ë“œì‹œ ê°ì • ê´€ë ¨ íƒœê·¸ë¥¼ 1~2ê°œ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤** (ì˜ˆ: í–‰ë³µ, ìš°ìš¸, ìŠ¤íŠ¸ë ˆìŠ¤, ì„¤ë ˜, íë§, í”¼ê³¤, ê°ë™, í™”ë‚¨ ë“±)
- íƒœê·¸ëŠ” ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„í•˜ì—¬ í•œ ì¤„ë¡œë§Œ ì¶œë ¥í•˜ê³ , ê·¸ ì™¸ì˜ ì–´ë–¤ ë¬¸ì¥ì´ë‚˜ ì„¤ëª…ë„ í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

**ì£¼ì˜:**
- ëª¨ë“  ë¶„ì„ ë° ì´ìœ  ì„¤ëª…ì€ ë‚´ë¶€ì ìœ¼ë¡œë§Œ ì§„í–‰í•˜ê³ , ìµœì¢… ì¶œë ¥ì—ëŠ” ë°˜ë“œì‹œ íƒœê·¸ë§Œ ë‚˜íƒ€ë‚˜ì•¼ í•©ë‹ˆë‹¤.
- ì¶©ë¶„íˆ ìµœì‹  ë§¥ë½ê³¼ ì„¸ë¶€ ê°ì •ì„ íŒŒì•…í•˜ì—¬ ê°€ì¥ ì •ë°€í•œ íƒœê·¸ë¥¼ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.

**ì¶œë ¥ í˜•ì‹:**
- í•œê¸€íƒœê·¸1,í•œê¸€íƒœê·¸2,í•œê¸€íƒœê·¸3
- ê³µë°± ì—†ì´ ì‰¼í‘œë¡œ êµ¬ë¶„
- ì„¤ëª… ì—†ì´ íƒœê·¸ë§Œ ì¶œë ¥

**ì˜ˆì‹œ:**
ì…ë ¥: ì˜¤ëŠ˜ ìƒˆë²½ì— ì¼ì–´ë‚˜ì„œ í˜¼ì í•œê°•ì„ ê±¸ì—ˆëŠ”ë°.. ì •ë§ ì¡°ìš©í•˜ê³  í‰í™”ë¡œì› ì–´ìš”
ì¶œë ¥: ìƒˆë²½ì‚°ì±…,íë§,í‰í™”ë¡œì›€

ì…ë ¥: ìƒì‚¬ì—ê²Œ í˜¼ë‚˜ê³  í•˜ë£¨ ì¢…ì¼ ê¸°ìš´ì´ ë¹ ì¡Œì–´ìš”. ìì¡´ê°ì´ ë°”ë‹¥ì„ ì¹˜ëŠ” ê²ƒ ê°™ì•„ ë„ˆë¬´ ê´´ë¡­ë„¤ìš”
ì¶œë ¥: ì§ì¥ìŠ¤íŠ¸ë ˆìŠ¤,ìš°ìš¸,ìì¡´ê°

ì…ë ¥: ì¹œêµ¬ë“¤ê³¼ ì˜¤ëœë§Œì— ë§›ìˆëŠ” ì €ë…ì„ ë¨¹ìœ¼ë©° ìˆ˜ë‹¤ ë–¨ê³  ì›ƒì—ˆë˜ í–‰ë³µí•œ ë°¤ì´ì—ˆì–´ìš”
ì¶œë ¥: ì¹œêµ¬ëª¨ì„,í–‰ë³µ,ì¦ê±°ì›€`,
   },
   {
     role: "user",
     content: `ê²Œì‹œê¸€: ${content}\níƒœê·¸:`,
   },
 ];
};

const generateTags = async (content) => {
const tags = [];
const messages = createTagPrompt(content);
tags = messages.content.split(",")
console.log("ğŸš€ ~ generateTags ~ tags:", tags)

 
 try {
   const response = await openai.chat.completions.create({
     model: "gpt-4o",
     messages,
     temperature: 1,
     max_tokens: 4000,
     top_p: 1,
   });
   console.log("ğŸš€ ~ generateTags ~ response:", response)

   const data = [...messages, response.choices[0].message];
   console.log("data", data);
   return data;
 } catch (error) {
   console.log(error);
   throw error;
 }
};

const testContents = [
 "íšŒì‚¬ì—ì„œ ì•¼ê·¼í•˜ê³  ì§‘ì— ì˜¤ëŠ” ê¸¸.. í¸ì˜ì ì—ì„œ ì•„ì´ìŠ¤í¬ë¦¼ í•˜ë‚˜ ì‚¬ë¨¹ê³  ìˆëŠ”ë° ì™œ ì´ë ‡ê²Œ ë‹¬ì½¤í•œì§€ ã…‹ã…‹ ì˜¤ëŠ˜ë„ ê³ ìƒí•œ ë‚˜ì—ê²Œ ì£¼ëŠ” ì‘ì€ ì„ ë¬¼ì´ë¼ê³  ìƒê°í•˜ë‹ˆê¹Œ ê¸°ë¶„ì´ ì¢‹ì•„ì§€ë„¤ìš” ğŸ’™",
 
 "ì˜¤ëŠ˜ ê¸°íšìí•œí…Œ 'ì´ê±° ë²„íŠ¼ ìƒ‰ê¹”ë§Œ ë°”ê¾¸ë©´ ë˜ì–ì•„ìš”~ 5ë¶„ì´ë©´ ë  ê²ƒ ê°™ì€ë°?' ë¼ëŠ” ë§ì„ ë“¤ì—ˆìŠµë‹ˆë‹¤.. ë„¤ ë§ìŠµë‹ˆë‹¤ 5ë¶„ ë§ìŠµë‹ˆë‹¤. ë””ìì¸ì‹œìŠ¤í…œ ëœ¯ì–´ê³ ì¹˜ê³  ë°˜ì‘í˜• ë‹¤ì‹œ ë§ì¶”ëŠ”ë° 5ì¼ ê±¸ë ¸ì§€ë§Œìš” ğŸ˜‡",
 
 "ìƒˆë²½ 2ì‹œì— ë°°í¬í–ˆëŠ”ë° ì—ëŸ¬ í„°ì ¸ì„œ ë¡¤ë°±í•˜ê³  ìˆëŠ” ì¤‘.. ì™œ ê°œë°œí•  ë• ì˜ ëëŠ”ë° ë°°í¬ë§Œ í•˜ë©´ ì´ëŸ´ê¹Œ ğŸ˜­ğŸ˜­ 'ì œ ì»´í“¨í„°ì—ì„œëŠ” ì˜ ë˜ëŠ”ë°ìš”?' ëŠ” ê°œë°œìì˜ ëª…ì–¸ì´ì§€ë§Œ ì§€ê¸ˆì€ ë„ˆë¬´ í˜„ì‹¤ì´ ì•„í”„ë‹¤ ã… ã…  #ì•¼ê·¼ê°"
];

export const testTagGenerate = async ()=>{
    const tags = [];
    testContents.forEach(async (Content) =>{
        const result = await generateTags(Content);
        console.log("ğŸš€ ~ testContents.forEach ~ result:", result)
       
    })
}